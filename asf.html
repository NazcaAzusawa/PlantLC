<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>calculateEssence é–¢æ•°ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼</title>
    
    <style>
        /* --- ğŸ¨ åŸºæœ¬ãƒ‡ã‚¶ã‚¤ãƒ³è¨­å®š --- */
        :root {
            --primary-color: #4368FA; /* ãƒ¡ã‚¤ãƒ³ã‚«ãƒ©ãƒ¼ (é’ç³») */
            --primary-rgb: 67, 104, 250; /* ãƒ¡ã‚¤ãƒ³ã‚«ãƒ©ãƒ¼ã®RGBå€¤ (focusæ™‚ç”¨) */
            --bg-color: #F8F9FA;      /* ãƒšãƒ¼ã‚¸å…¨ä½“ã®èƒŒæ™¯è‰² (éå¸¸ã«è–„ã„ã‚°ãƒ¬ãƒ¼) */
            --panel-bg: #FFFFFF;    /* ãƒ‘ãƒãƒ«ã®èƒŒæ™¯è‰² (ç™½) */
            --border-color: #E0E3E8;  /* å¢ƒç•Œç·šã®è‰² */
            --text-color: #212529;    /* åŸºæœ¬ãƒ†ã‚­ã‚¹ãƒˆè‰² (æ¿ƒã„ã‚°ãƒ¬ãƒ¼) */
            --text-light: #6C757D;   /* ã‚µãƒ–ãƒ†ã‚­ã‚¹ãƒˆè‰² (è–„ã„ã‚°ãƒ¬ãƒ¼) */
            
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            --shadow-hover: 0 6px 16px rgba(0, 0, 0, 0.08);
            
            --radius-md: 8px;
            --radius-lg: 10px;
        }

        /* --- ğŸ“„ ãƒšãƒ¼ã‚¸å…¨ä½“ --- */
        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 24px;
            
            /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ */
            display: flex;
            flex-wrap: wrap; 
            gap: 24px;
            justify-content: center;
        }

        /* --- ğŸ›ï¸ ãƒ‘ãƒãƒ«åŸºæœ¬ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ --- */
        .panel {
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            background-color: var(--panel-bg);
            box-shadow: var(--shadow);
            padding: 24px;
            
            /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ */
            flex: 1 1 45%; 
            min-width: 320px;
            box-sizing: border-box;
        }
        
        h2, h3 {
            margin-top: 0;
            margin-bottom: 20px;
            color: var(--text-color);
        }
        h2 {
            font-size: 1.6em;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 10px;
        }
        h3 {
            font-size: 1.2em;
            color: var(--text-light);
            font-weight: 500;
        }

        /* --- ğŸ“‘ ã‚¿ãƒ–UI --- */
        .tabs {
            display: flex; /* ã‚¿ãƒ–ã‚’æ¨ªä¸¦ã³ã« */
            border-bottom: 2px solid var(--border-color);
            margin-bottom: 24px;
        }
        .tab-button {
            display: block;
            flex: 1; /* å‡ç­‰å¹… */
            padding: 12px 8px;
            margin-bottom: -2px; /* å¢ƒç•Œç·šã‚’é‡ã­ã‚‹ãŸã‚ */
            border: none;
            border-bottom: 2px solid transparent; /* éã‚¢ã‚¯ãƒ†ã‚£ãƒ–æ™‚ã¯é€æ˜ */
            background-color: transparent;
            cursor: pointer;
            text-align: center;
            font-size: 0.95em;
            font-weight: 600;
            color: var(--text-light);
            transition: color 0.2s, border-color 0.2s;
        }
        .tab-button:hover {
            color: var(--text-color);
        }
        .tab-button.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }

        /* --- âŒ¨ï¸ ãƒ•ã‚©ãƒ¼ãƒ è¦ç´  --- */
        .input-group {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        .input-group label {
            font-weight: 500;
            flex-basis: 100px;
            color: var(--text-light);
            font-size: 0.9em;
        }
        .input-group input[type="number"],
        .input-group input[type="text"] {
            flex: 1;
            padding: 10px 12px;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            background-color: var(--bg-color); /* èƒŒæ™¯ã¨åŒã˜è‰² */
            font-size: 1em;
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        .input-group input:focus {
            outline: none;
            border-color: var(--primary-color);
            background-color: var(--panel-bg);
            /* focusãƒªãƒ³ã‚°ã‚’å½±ã§è¡¨ç¾ */
            box-shadow: 0 0 0 3px rgba(var(--primary-rgb), 0.1); 
        }

        /* --- ğŸ—‘ï¸ ãƒªã‚¹ãƒˆé …ç›®ï¼ˆå…‰é‡ã€çŒæ°´ãªã©ï¼‰ --- */
        .list-item {
            border: 1px dashed var(--border-color);
            border-radius: var(--radius-md);
            padding: 12px;
            margin-bottom: 12px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
        }
        .list-item input {
            width: 60px;
            padding: 8px;
            font-size: 0.9em;
            background-color: var(--panel-bg);
        }
        /* å‰Šé™¤ãƒœã‚¿ãƒ³ */
        .list-item button {
            background-color: #FEEEEE;
            color: #E53E3E;
            font-size: 0.8em;
            padding: 6px 10px;
            margin-left: auto; /* å³å¯„ã› */
        }
        .list-item button:hover {
            background-color: #FED7D7;
            color: #C53030;
        }

        /* --- ğŸ”˜ ãƒœã‚¿ãƒ³ --- */
        button {
            padding: 10px 16px;
            font-size: 0.95em;
            font-weight: 600;
            border: none;
            border-radius: var(--radius-md);
            cursor: pointer;
            background-color: #28a745; /* è¿½åŠ ãƒœã‚¿ãƒ³ (ç·‘) */
            color: white;
            transition: background-color 0.2s, transform 0.1s, box-shadow 0.2s;
        }
        button:hover {
            transform: translateY(-2px); /* å°‘ã—æµ®ãä¸ŠãŒã‚‹ */
            box-shadow: var(--shadow-hover);
        }
        button:active {
            transform: translateY(0);
        }
        
        /* ç”Ÿæˆãƒœã‚¿ãƒ³ (ãƒ—ãƒ©ã‚¤ãƒãƒª) */
        #generate-button {
            background-color: var(--primary-color);
            padding: 14px 20px;
            width: 100%;
            font-size: 1.1em;
        }
        #generate-button:hover {
            background-color: #3a5ce0;
        }
        
        /* å‰Šé™¤ãƒœã‚¿ãƒ³ã®ãƒ›ãƒãƒ¼æŒ™å‹•ã‚’ä¸Šæ›¸ã */
        .list-item button:hover {
            transform: none;
            box-shadow: none;
        }

        /* --- ğŸ–¥ï¸ å‡ºåŠ›ã‚¨ãƒªã‚¢ --- */
        #output-area {
            margin-top: 20px;
        }
        #output-code {
            width: 100%;
            height: 500px;
            font-family: "Fira Code", "Courier New", monospace; /* ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”¨ãƒ•ã‚©ãƒ³ãƒˆ */
            font-size: 0.9em;
            line-height: 1.6;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: 15px;
            box-sizing: border-box;
            resize: vertical;
            background-color: #FDFDFD;
        }
        #output-code:focus {
             outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(var(--primary-rgb), 0.1);
        }
    </style>
</head>
<body>

    <div class="panel">
        <h2>ã‚¹ã‚³ã‚¢è¨­å®š</h2>
        <div class="tabs">
            <button class="tab-button" onclick="showTab('light')">å…‰é‡ (ç¯„å›²)</button>
            <button class="tab-button" onclick="showTab('temp')">æ¸©åº¦ (å›ºå®š)</button>
            <button class="tab-button" onclick="showTab('water')">çŒæ°´ (ç¯„å›²)</button>
            <button class="tab-button" onclick="showTab('fert')">è‚¥æ–™ (å›ºå®š)</button>
            <button class="tab-button" onclick="showTab('essence')">ã‚¨ãƒƒã‚»ãƒ³ã‚¹ (ä»¥ä¸Š)</button>
        </div>

        <div id="tab-light" class="tab-content active">
            <h3>å…‰é‡ã‚¹ã‚³ã‚¢ (lightScore)</h3>
            <div id="light-list"></div>
            <button onclick="addRangeItem('light')">ç¯„å›²ã‚’è¿½åŠ </button>
        </div>
        
        <div id="tab-temp" class="tab-content">
            <h3>æ¸©åº¦ã‚¹ã‚³ã‚¢ (tempScore)</h3>
            <div class="input-group"><label>Lv 1:</label> <input type="number" id="temp-1" value="0"> ç‚¹</div>
            <div class="input-group"><label>Lv 2:</label> <input type="number" id="temp-2" value="0"> ç‚¹</div>
            <div class="input-group"><label>Lv 3:</label> <input type="number" id="temp-3" value="1"> ç‚¹</div>
            <div class="input-group"><label>Lv 4:</label> <input type="number" id="temp-4" value="2"> ç‚¹</div>
            <div class="input-group"><label>Lv 5:</label> <input type="number" id="temp-5" value="3"> ç‚¹</div>
        </div>

        <div id="tab-water" class="tab-content">
            <h3>çŒæ°´ã‚¹ã‚³ã‚¢ (waterScore)</h3>
            <div id="water-list"></div>
            <button onclick="addRangeItem('water')">ç¯„å›²ã‚’è¿½åŠ </button>
        </div>
        
        <div id="tab-fert" class="tab-content">
            <h3>è‚¥æ–™ã‚¹ã‚³ã‚¢ (fertilizerScore)</h3>
            <div class="input-group"><label>æ–½è‚¥ãªã—:</label> <input type="number" id="fert-null" value="-10"> ç‚¹</div>
            <div class="input-group"><label>ç·‘:</label> <input type="number" id="fert-green" value="0"> ç‚¹</div>
            <div class="input-group"><label>ç´«:</label> <input type="number" id="fert-purple" value="3"> ç‚¹</div>
            <div class="input-group"><label>æ©™:</label> <input type="number" id="fert-orange" value="0"> ç‚¹</div>
        </div>
        
        <div id="tab-essence" class="tab-content">
            <h3>ã‚¨ãƒƒã‚»ãƒ³ã‚¹å¤‰æ› (essenceLevels)</h3>
            <p style="color: var(--text-light); font-size: 0.9em; margin-top: -15px;">â€» ã‚¹ã‚³ã‚¢ãŒé«˜ã„é †ï¼ˆé™é †ï¼‰ã§è¨­å®šã—ã¦ãã ã•ã„</p>
            <div id="essence-list"></div>
            <button onclick="addEssenceItem()">ãƒ¬ãƒ™ãƒ«ã‚’è¿½åŠ </button>
        </div>
    </div>

    <div class="panel">
        <h2>å‡ºåŠ›è¨­å®š</h2>
        <div class="input-group">
            <label for="plant-id">æ¤ç‰©ID (kocho):</label>
            <input type="text" id="plant-id" value="kocho">
        </div>
        <div class="input-group">
            <label for="plant-name-jp">æ—¥æœ¬èªå (ã‚³ãƒãƒ§ãƒ©ãƒ³):</label>
            <input type="text" id="plant-name-jp" value="ã‚³ãƒãƒ§ãƒ©ãƒ³">
        </div>
        <div class="input-group">
            <label for="func-name">é–¢æ•°å (Kocho):</label>
            <input type="text" id="func-name" value="Kocho">
        </div>
        
        <button id="generate-button" onclick="generateFunction()">é–¢æ•°ã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆ</button>
        
        <div id="output-area">
            <h3>ç”Ÿæˆçµæœ</h3>
            <textarea id="output-code" spellcheck="false"></textarea>
        </div>
    </div>

    <script>
        // --- ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ ---
        function showTab(tabName) {
            // ã™ã¹ã¦ã®ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’éè¡¨ç¤ºã«
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            // ã™ã¹ã¦ã®ã‚¿ãƒ–ãƒœã‚¿ãƒ³ã®ãƒã‚¤ãƒ©ã‚¤ãƒˆã‚’è§£é™¤
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            
            // å¯¾è±¡ã®ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’è¡¨ç¤º
            document.getElementById('tab-' + tabName).classList.add('active');
            
            // å¯¾è±¡ã®ã‚¿ãƒ–ãƒœã‚¿ãƒ³ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
            const buttons = document.querySelectorAll('.tab-button');
            buttons.forEach(btn => {
                if (btn.getAttribute('onclick').includes(`'${tabName}'`)) {
                    btn.classList.add('active');
                }
            });
        }

        // --- ç¯„å›²ãƒªã‚¹ãƒˆé …ç›®ï¼ˆå…‰é‡ãƒ»çŒæ°´ï¼‰ ---
        function addRangeItem(type) {
            const list = document.getElementById(type + '-list');
            const item = document.createElement('div');
            item.className = 'list-item';
            item.innerHTML = `
                Min: <input type="number" class="${type}-min" value="0">
                Max: <input type="number" class="${type}-max" value="0">
                Score: <input type="number" class="${type}-score" value="0">
                <button onclick="this.parentElement.remove()">å‰Šé™¤</button>
            `;
            list.appendChild(item);
        }

        // --- ã‚¨ãƒƒã‚»ãƒ³ã‚¹ãƒªã‚¹ãƒˆé …ç›® ---
        function addEssenceItem() {
            const list = document.getElementById('essence-list');
            const item = document.createElement('div');
            item.className = 'list-item';
            item.innerHTML = `
                Score >= <input type="number" class="essence-minScore" value="0">
                Essence: <input type="number" class="essence-essence" value="0">
                <button onclick="this.parentElement.remove()">å‰Šé™¤</button>
            `;
            list.appendChild(item);
        }

        // --- åˆæœŸãƒ‡ãƒ¼ã‚¿ï¼ˆã‚³ãƒãƒ§ãƒ©ãƒ³ã®ä¾‹ï¼‰---
        function loadKochoExample() {
            // å…‰é‡
            addRangeItem('light'); document.querySelector('.light-min').value = 0; document.querySelector('.light-max').value = 15; document.querySelector('.light-score').value = 2;
            addRangeItem('light'); document.querySelectorAll('.light-min')[1].value = 16; document.querySelectorAll('.light-max')[1].value = 49; document.querySelectorAll('.light-score')[1].value = 3;
            addRangeItem('light'); document.querySelectorAll('.light-min')[2].value = 50; document.querySelectorAll('.light-max')[2].value = 69; document.querySelectorAll('.light-score')[2].value = 0;
            addRangeItem('light'); document.querySelectorAll('.light-min')[3].value = 70; document.querySelectorAll('.light-max')[3].value = 89; document.querySelectorAll('.light-score')[3].value = -1;
            addRangeItem('light'); document.querySelectorAll('.light-min')[4].value = 90; document.querySelectorAll('.light-max')[4].value = 100; document.querySelectorAll('.light-score')[4].value = -2;
            // çŒæ°´
            addRangeItem('water'); document.querySelector('.water-min').value = 0; document.querySelector('.water-max').value = 0; document.querySelector('.water-score').value = 0;
            addRangeItem('water'); document.querySelectorAll('.water-min')[1].value = 1; document.querySelectorAll('.water-max')[1].value = 3; document.querySelectorAll('.water-score')[1].value = 1;
            addRangeItem('water'); document.querySelectorAll('.water-min')[2].value = 4; document.querySelectorAll('.water-max')[2].value = 999; document.querySelectorAll('.water-score')[2].value = 0;
            // ã‚¨ãƒƒã‚»ãƒ³ã‚¹
            addEssenceItem(); document.querySelector('.essence-minScore').value = 10; document.querySelector('.essence-essence').value = 50;
            addEssenceItem(); document.querySelectorAll('.essence-minScore')[1].value = 8; document.querySelectorAll('.essence-essence')[1].value = 35;
            addEssenceItem(); document.querySelectorAll('.essence-minScore')[2].value = 6; document.querySelectorAll('.essence-essence')[2].value = 20;
            addEssenceItem(); document.querySelectorAll('.essence-minScore')[3].value = 4; document.querySelectorAll('.essence-essence')[3].value = 10;
            addEssenceItem(); document.querySelectorAll('.essence-minScore')[4].value = 1; document.querySelectorAll('.essence-essence')[4].value = 5;
            addEssenceItem(); document.querySelectorAll('.essence-minScore')[5].value = 0; document.querySelectorAll('.essence-essence')[5].value = 0; // 0ç‚¹ä»¥ä¸‹ã¯0
        }
        
        // --- é–¢æ•°ã‚³ãƒ¼ãƒ‰ç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯ ---
        function generateFunction() {
            const plantId = document.getElementById('plant-id').value;
            const plantNameJp = document.getElementById('plant-name-jp').value;
            const funcName = document.getElementById('func-name').value;
            
            if (!funcName) {
                alert('ã€Œé–¢æ•°åã€ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚ (ä¾‹: Kocho)');
                return;
            }
            
            let code = `function calculateEssence${funcName}(plant) {\n`;
            code += `    const params = plant.harvestParams;\n`;
            code += `    const { waterCount, fertilizerColor, fertilizerGiven, lightLevel, tempLevel } = params;\n\n`;
            code += `    console.log('${plantNameJp} ã‚¨ãƒƒã‚»ãƒ³ã‚¹è¨ˆç®—:', params);\n\n`;
            code += `    // ç·åˆã‚¹ã‚³ã‚¢è¨ˆç®—\n`;
            code += `    let totalScore = 0;\n\n`;

            // --- å…‰é‡ã‚¹ã‚³ã‚¢ ---
            code += `    // å…‰é‡ã‚¹ã‚³ã‚¢\n`;
            code += `    let lightScore = 0;\n`;
            const lightItems = Array.from(document.querySelectorAll('#light-list .list-item'));
            lightItems.forEach((item, index) => {
                const min = item.querySelector('.light-min').value;
                const max = item.querySelector('.light-max').value;
                const score = item.querySelector('.light-score').value;
                const prefix = (index === 0) ? 'if' : 'else if';
                code += `    ${prefix} (lightLevel >= ${min} && lightLevel <= ${max}) lightScore = ${score};\n`;
            });
            code += `    totalScore += lightScore;\n\n`;

            // --- æ¸©åº¦ã‚¹ã‚³ã‚¢ ---
            code += `    // æ¸©åº¦ã‚¹ã‚³ã‚¢\n`;
            code += `    let tempScore = 0;\n`;
            for (let i = 1; i <= 5; i++) {
                const score = document.getElementById(`temp-${i}`).value;
                const prefix = (i === 1) ? 'if' : 'else if';
                code += `    ${prefix} (tempLevel === ${i}) tempScore = ${score};\n`;
            }
            code += `    totalScore += tempScore;\n\n`;
            
            // --- çŒæ°´ã‚¹ã‚³ã‚¢ ---
            code += `    // çŒæ°´ã‚¹ã‚³ã‚¢\n`;
            code += `    let waterScore = 0;\n`;
            const waterItems = Array.from(document.querySelectorAll('#water-list .list-item'));
            waterItems.forEach((item, index) => {
                const min = item.querySelector('.water-min').value;
                const max = item.querySelector('.water-max').value;
                const score = item.querySelector('.water-score').value;
                
                let condition = `waterCount >= ${min}`;
                if (parseInt(max) < 900) {
                     condition += ` && waterCount <= ${max}`;
                }
                
                if (min === max) {
                    condition = `waterCount === ${min}`;
                }

                const prefix = (index === 0) ? 'if' : 'else if';
                code += `    ${prefix} (${condition}) waterScore = ${score};\n`;
            });
            code += `    totalScore += waterScore;\n\n`;

            // --- è‚¥æ–™ã‚¹ã‚³ã‚¢ ---
            code += `    // æ–½è‚¥ã‚¹ã‚³ã‚¢\n`;
            code += `    let fertilizerScore = 0;\n`;
            const fertNone = document.getElementById('fert-null').value;
            const fertGreen = document.getElementById('fert-green').value;
            const fertPurple = document.getElementById('fert-purple').value;
            const fertOrange = document.getElementById('fert-orange').value;
            
            code += `    if (fertilizerGiven && fertilizerColor === 'ç·‘') fertilizerScore = ${fertGreen};\n`;
            code += `    else if (fertilizerGiven && fertilizerColor === 'ç´«') fertilizerScore = ${fertPurple};\n`;
            code += `    else if (fertilizerGiven && fertilizerColor === 'æ©™') fertilizerScore = ${fertOrange};\n`;
            code += `    else fertilizerScore = ${fertNone}; // æ–½è‚¥ãªã—\n`;
            code += `    totalScore += fertilizerScore;\n\n`;

            // --- ãƒ­ã‚° ---
            code += `    console.log('${plantNameJp} å€‹åˆ¥ã‚¹ã‚³ã‚¢:', {\n`;
            code += `        lightLevel, lightScore,\n`;
            code += `        tempLevel, tempScore,\n`;
            code += `        waterCount, waterScore,\n`;
            code += `        fertilizerColor, fertilizerGiven, fertilizerScore,\n`;
            code += `        totalScore\n`;
            code += `    });\n\n`;
            
            // --- ã‚¨ãƒƒã‚»ãƒ³ã‚¹å¤‰æ› ---
            code += `    // ã‚¨ãƒƒã‚»ãƒ³ã‚¹å¤‰æ›\n`;
            code += `    let essence = 0;\n`;
            const essenceItems = Array.from(document.querySelectorAll('#essence-list .list-item'));
            const sortedEssenceItems = essenceItems.map(item => ({
                minScore: parseInt(item.querySelector('.essence-minScore').value),
                essence: parseInt(item.querySelector('.essence-essence').value)
            })).sort((a, b) => b.minScore - a.minScore);
            
            sortedEssenceItems.forEach((item, index) => {
                const prefix = (index === 0) ? 'if' : 'else if';
                code += `    ${prefix} (totalScore >= ${item.minScore}) essence = ${item.essence};\n`;
            });
            if (sortedEssenceItems.length > 0 && sortedEssenceItems[sortedEssenceItems.length - 1].minScore > 0) {
                 code += `    else essence = 0;\n`;
            } else if (sortedEssenceItems.length === 0) {
                 code += `    essence = 0; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ\n`;
            }

            code += `\n`;
            code += `    console.log('${plantNameJp} è¨ˆç®—çµæœ:', { totalScore, essence });\n\n`;
            code += `    return essence;\n`;
            code += `}\n\n`;
            
            // --- ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ ---
            code += `// Node.jsï¼ˆJestï¼‰ã§èª­ã¿è¾¼ã‚€ãŸã‚ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ\n`;
            code += `if (typeof module !== 'undefined') {\n`;
            code += `    module.exports = { calculateEssence${funcName} };\n`;
            code += `}\n`;

            document.getElementById('output-code').value = code;
        }
        
        // --- åˆæœŸåŒ– ---
        loadKochoExample(); // ã‚³ãƒãƒ§ãƒ©ãƒ³ã®ä¾‹ã‚’èª­ã¿è¾¼ã‚€
        showTab('light'); // æœ€åˆã®ã‚¿ãƒ–ã‚’è¡¨ç¤º
    </script>
</body>
</html>